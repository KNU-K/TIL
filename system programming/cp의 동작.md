## cp의 동작

- 아래가 cp 의 기본 매커니즘이다.

```
[default 매커니즘]

 file1_fd = open(file1, O_RDONLY)
 file2_fd = create(file1, 0664)

    read(file1_fd, buf, bu_sz) <------------- ---┐
        file2_fd 에 buf 주입                     │
     └------------------------------------------┘
```

- cp 의 일반 복사

  - [source](./excercise/cp1.c)

- cp의 2개의 복사 인자가 같을 때 복사

  - [source](./excercise/cp2.c)

  - strcmp 로 인자가 같은지 판별 한다.

- 2번째 인자에 폴더가 올 때

  - [source](./excercise/cp3.c)

  - flow

    1. 2번째 인자가 폴더인지 stat를 이용해서 판별

    2. 판별 이후에, 첫번째 인자가 절대경로나 상대경로인것을 유의하고, 파일명을 따로 가져온다.

    3. chdir 로 파일 위치 변경해서 디스크립터로 바로 쓸 수 있게 환경을 만든다.

    4. 1번째 인자와 동일 파일명으로 해당 폴더에 복사

- cp 의 경우에는 복사하는 기능이다. optional한 부분을 제외하고 아래와 같은 based case가 존재한다.

  - 기본 형태 : cp [복사할 파일] [복사가 진행되는 파일 및 폴더]

  - 복사할 파일이 폴더인 경우

    - 전체 폴더의 파일을 가져온후, 쓰기를 진행한다. (따로 구현하지는 않음)

  - 복사할 파일이 일반 Reg 파일인 경우

    - 그 파일로 복사를 진행한다.
      > 이 때, 파일명에 경로가 포함된 경우 파일명만 가지고 온다.

  - 복사가 진행되는 곳이 파일인 경우

    - 복사할 파일과 이름이 같은지 확인한다.
    - 해당 폴더로 이동해서 복사를 진행한다.

  - 복사가 진행되는 곳이 폴더인 경우
    - 폴더내로 이동해서 복사할 파일명과 같은 파일로 쓰기를 진행한다.
      > 두개의 인자가 모두 폴더인경우 1번인자 폴더내의 파일들을 2번인자 폴더로 전체 복사한다.
